import org.ehcache.core.Ehcache;
import org.springframework.cache.jcache.JCacheCacheManager;

import javax.cache.Cache;
import javax.cache.CacheManager;
import javax.cache.Caching;

public void logEhcacheStats(org.springframework.cache.CacheManager springCacheManager) {
    if (springCacheManager instanceof JCacheCacheManager jCacheCacheManager) {
        CacheManager jCacheManager = jCacheCacheManager.getCacheManager();

        for (String name : jCacheManager.getCacheNames()) {
            Cache<?, ?> cache = jCacheManager.getCache(name);
            if (cache != null) {
                // Unwrap to native Ehcache
                org.ehcache.Cache<?, ?> nativeCache = cache.unwrap(org.ehcache.Cache.class);
                if (nativeCache instanceof Ehcache<?, ?> ehcache) {
                    System.out.println("Stats for cache [" + name + "]:");
                    System.out.println("Hits: " + ehcache.getStatistics().getCacheHits());
                    System.out.println("Misses: " + ehcache.getStatistics().getCacheMisses());
                    System.out.println("Evictions: " + ehcache.getStatistics().getCacheEvictions());
                }
            }
        }
    }
}
